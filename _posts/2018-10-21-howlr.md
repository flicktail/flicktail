---
layout: post
title: Howlr Security
permalink: /howlr
---

![Spring Icon]({{ site.baseurl }}/images/spring-icon.png){:.center-image}

# Who?
Hey! I’m Spring, a reverse engineer from the UK and user of Howlr. I’ve been asked by a few friends whether the project was ‘secure’ and thought the best way to answer that question was to have a look at how it works. Howlr is a bit of a moving target, I’ll try and re-visit after big changes but no promises <3!

After reporting the issues I found to Howlr, they’ve given the green light for me to publish.

![Howlr Logo]({{ site.baseurl }}/images/2018-10-howlr/howlr-otter.png){:width="150px" .center-image }

# TLDR;
Howlr's security is actually pretty solid. There were certainly no critical flaws
that I managed to find. That being said, it's not perfect and you shouldn't treat
it as such.

# Technical Bit

## Registration
![Registration Page]({{ site.baseurl}}/images/2018-10-howlr/1-registration.png){:.center-image}

There are two separate workflows for registration. One where Telegram is installed on the same device, and one where Telegram is on a different device.

### Same Device Flow:
- “Sign Up” button pressed
- A code is generated, Howlr then opens link `https://telegram.me/HowlrBot?start=code`
- Telegram HowlrBot webhook redirects and opens HowlrBot in the Telegram app
- Pressing “Start” in the bot will register that code
- That code is what ties the Telegram and Howlr accounts together

### Different Device Flow:
- “Sign Up” button pressed
- Howlr app asks for a code
- Open Telegram on other device, send `/start` command to HowlrBot
- HowlrBot returns a code
- Enter the code into the Howlr app. Telegram and Howlr accounts are not tied together

### Is it safe?
The code in this case is version 4 UUID, meaning there’s practically no chance of guessing one successfully. When registered the UUID is used as your “Fluff” authorization code.

**BUT, if you open a random link and it takes you to the HowlrBot in Telegram. Pressing “Start” in the bot will give whoever created that link full access to your Howlr account. So just don’t press start.**

## Creating your profile
![Bio]({{ site.baseurl}}/images/2018-10-howlr/2-bio.png){:.center-image}

![Bio Update]({{ site.baseurl}}/images/2018-10-howlr/3-bio-update.png){:.center-image}

When you save content to your profile, a JSON request is sent to the Howlr API with whatever content you’ve put in your profile. For example:

{% highlight json %}
{
  "session": {
    "user_attributes": {
      "id": "06349fdb-7cc6-4b01-876e-bfb39be8c3f1",
      "bio": "Just a friendly deer that enjoys nature and meeting new friends ^ - ^"
    }
  }
}
{% endhighlight %}

This is sent as an HTTP PUT request to the URL:

`https://api.howlr.im/sessions/[FLUFF CODE].json`

The code that was generated during registration is the “Fluff Code”. This code is also sent as an HTTP header.

`authorization: Fluff [FLUFF CODE]`

The “id” in this case is unrelated to the Fluff Code, it is shared with any chat or search result. Which is why I’ve not redacted it.

**Attempting to change someone else's profile by using their ID in the request just returns a “404 Not Found” error. Which is great!
Character encoding/escaping also looked to be totally fine
Attempting to change values we shouldn’t be able to (like ID) returns HTTP 200, but the changes are ignored**

## Groups
![Groups]({{ site.baseurl}}/images/2018-10-howlr/4-groups.png){:.center-image}

![Groups Request]({{ site.baseurl}}/images/2018-10-howlr/5-groups-update.png){:.center-image}

Setting up your groups, orientation and relationship status are pretty simple, each is represented by a UUID. Similar to updating your profile, these are sent along in a JSON request and associated with the account.

**Trying to add yourself to a group that doesn’t exist just results in a 404 error.**

**Trying to add someone else to various groups also just results in a 404 error.**

## Profile Images
The requests for updating images is slightly different. It’s still an HTTP PUT to the same URI as other changes to the profile:

`PUT /sessions/[FLUFF ID].json`

However, instead of being a JSON structure in the HTTP body, instead there request is a multipart/form-data type. This gives a few more options to play with.
![Bio]({{ site.baseurl}}/images/2018-10-howlr/6-bio-image.png){:.center-image}

![Bio Update]({{ site.baseurl}}/images/2018-10-howlr/6-bio-update.png){:.center-image}


There are effectively two parameters being supplied here. Firstly the user’s ID in the form field: “session[user_attributes][id]” and secondly the form field “session[user_attributes[avatar]”.
The “filename” parameter does not appear to actually do anything,

When images are uploaded, they’re split into various sizes and uploaded to an S3 bucket. The images are then available through Amazon CloudFront URLs

**Deleting images takes about 24 hours to take effect, but they ARE deleted from CloudFront.**

**Attempting to delete other people’s stuff fails**

## Searching
Now that we’ve created a profile, lets look at the search requests used to find other nearby furrys.

![Searching]({{ site.baseurl}}/images/2018-10-howlr/7-search.png){:.center-image}
![Search Request]({{ site.baseurl}}/images/2018-10-howlr/8-search-request.png){:.center-image}
